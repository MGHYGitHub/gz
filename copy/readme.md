
# 自动化文件复制批处理脚本

## 项目简介

这是一个基于 Windows 批处理文件的自动化文件复制脚本。该脚本支持手动执行、定时任务执行和定时间隔执行等功能。它能够将指定源文件夹中的文件复制到目标文件夹，并且可以设置任务在指定时间或按指定间隔自动执行。支持管理员权限的自动提升，并且能够处理包含中文字符的路径。

## 功能

- **文件复制**：通过 `robocopy` 命令将源文件夹中的文件复制到目标文件夹。
- **手动执行**：可以手动触发一次复制操作。
- **定时执行**：支持设置定时任务，指定某个时间点执行复制操作。
- **间隔执行**：支持设置任务按分钟或小时间隔执行。
- **管理员权限**：脚本会自动检测是否有管理员权限，如果没有会请求管理员权限运行。
- **中文路径支持**：支持包含中文字符的源路径和目标路径。

## 安装与使用

### 安装要求

- Windows 操作系统
- `robocopy` 命令（Windows 自带）
- 本脚本支持 Windows 7 及以上版本

### 使用方法

1. **下载脚本文件**
   下载并保存 `copy_script.bat` 文件到本地计算机。

2. **设置文件夹路径**
   在脚本文件中设置源文件夹路径（`SOURCE_DIR`）和目标文件夹路径（`DEST_DIR`）。例如：
   
   ```batch
   set "SOURCE_DIR=C:\Users\YourUsername\Desktop\source"
   set "DEST_DIR=C:\Users\YourUsername\Desktop\destination"
   ```
   
3. **设置定时任务**
   - **立即执行**：直接运行脚本，文件会立即被复制。
   - **定时任务**：
     - 可以设置在特定时间执行复制操作。修改 `SPECIFIC_TIME` 为目标时间，格式为 `HH:mm`。
     - 可以设置按间隔执行任务。修改 `INTERVAL_HOURS` 或 `INTERVAL_MINUTES` 为任务执行间隔。

4. **运行脚本**
   直接双击 `copy_script.bat` 文件，或者右键选择“以管理员身份运行”以获取管理员权限。

### 定时任务设置

- **指定时间执行**：通过修改 `SPECIFIC_TIME` 变量来设置任务在指定时间执行。例如：
  ```batch
  set SPECIFIC_TIME=14:00
  ```
  这将会使任务每天在 14:00 执行。

- **按间隔执行**：设置任务每隔一定时间执行。可以修改 `INTERVAL_HOURS` 或 `INTERVAL_MINUTES` 来指定间隔时间。例如：
  ```batch
  set INTERVAL_MINUTES=1
  ```
  这将会设置任务每隔 1 分钟执行一次。

### 脚本工作原理

1. **检查管理员权限**：
   脚本会首先检查当前用户是否具有管理员权限。如果没有管理员权限，脚本会自动以管理员身份重新启动。

2. **执行文件复制**：
   脚本会使用 `robocopy` 命令复制源文件夹中的文件到目标文件夹，支持复制所有文件、文件夹、时间戳等。

3. **定时任务创建**：
   根据设置的定时模式，脚本会创建 Windows 定时任务，通过 `schtasks` 命令设置任务按指定时间或间隔执行。

4. **自动退出**：
   脚本执行完成后，会自动退出。如果设置了定时任务，脚本会在最后显示任务计划已创建。

## 脚本配置说明

- `SOURCE_DIR`：指定源文件夹路径。
- `DEST_DIR`：指定目标文件夹路径。
- `MODE`：设置操作模式（1-手动执行，2-定时执行，3-间隔执行）。
- `SPECIFIC_TIME`：设置定时任务的执行时间（例如：`14:00`）。
- `INTERVAL_HOURS`：设置任务每隔多少小时执行。
- `INTERVAL_MINUTES`：设置任务每隔多少分钟执行。
- `TIMED_MODE`：选择定时任务模式，1 为手动执行，2 为指定时间执行，3 为间隔执行。

## 注意事项

1. **路径格式**：路径中不应包含非 ASCII 字符，尤其是中文字符，可能导致 `robocopy` 无法正确识别。
2. **管理员权限**：脚本需要管理员权限才能正确设置和执行任务。
3. **任务冲突**：如果脚本创建的定时任务已经存在，任务将会被覆盖。请确保任务名唯一。

## 错误代码说明

- `errorlevel = 1`：复制操作成功完成，但出现了警告（通常是目标文件夹中的文件已存在或其他问题）。
- `errorlevel > 1`：复制操作失败，可能是由于文件夹路径不正确、权限问题或其他错误。

## 删除定时任务的批处理脚本

### 脚本说明

1. **管理员权限检查**： 脚本首先检查当前用户是否具有管理员权限。如果没有，脚本将会以管理员权限重新启动。
2. **删除定时任务**： 使用 `schtasks /delete` 命令删除之前创建的定时任务 `"CopyTask"`。如果任务已经不存在，该命令也不会报错。
3. **删除附属文件**： 该脚本尝试删除附属文件，例如之前创建的 `copy_script.bat` 文件。如果该文件存在，脚本会删除它。
4. **删除完成**： 最后，脚本会显示一条信息，说明任务和附属文件已经成功删除。

### 使用方法

1. **下载并保存脚本**： 将上面的批处理脚本保存为一个 `.bat` 文件，例如 `delete_task.bat`。
2. **运行脚本**： 双击 `delete_task.bat` 或者右键选择“以管理员身份运行”，以删除之前创建的定时任务和附属文件。
3. **验证任务是否删除**： 可以打开“任务计划程序”验证定时任务是否已被删除。

## 联系方式

如有任何问题或建议，欢迎通过以下方式联系我：

- Email: your.email@example.com
- GitHub: https://github.com/yourusername

## 许可证

本项目采用 MIT 许可证，详情请查看 [LICENSE](LICENSE) 文件。

---

感谢使用此脚本，祝你使用愉快！